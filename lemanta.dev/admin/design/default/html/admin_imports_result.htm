{* <!-- ===========================================================================
                                                                                  |
    Страница: Результаты импорта.                                                 |
    ----------------------------------------------------------------------------  |
                                                                                  |
    Входные переменные:                                                           |
        $item = запись о варианте импорта                                         |
        $message = текст информационного сообщения, если есть                     |
        $error = текст сообщения об ошибке, если была                             |
        $ProductsAdded = количество добавленных товаров                           |
        $ProductsUpdated = количество обновленных товаров                         |
        $ProductsSkipped = количество неизменившихся товаров                      |
        $ProductsDeletedAncientQ0 = количество удаленных устаревших товаров       |
                                    (отсутствующих на складе)                     |
        $ProductsDeletedAncientS0 = количество удаленных устаревших товаров       |
                                    (обесцененных)                                |
        $VariantsAdded = количество добавленных вариантов товаров                 |
        $VariantsUpdated = количество обновленных вариантов товаров               |
        $VariantsSkipped = количество неизменившихся вариантов товаров            |
        $CategoriesAdded = количество добавленных категорий                       |
        $BrandsAdded = количество добавленных брендов                             |
        $PropertiesAdded = количество добавленных свойств товаров                 |
        $StatisticData = статистика импорта:                                      |
                             ->empties = массив номеров пустых строк              |
                             ->skips = массив номеров отклоненных строк           |
                             ->bads = массив номеров строк с другим числом ячеек, |
                                      формат элемента: номер => число ячеек       |
                             ->ids = массив номеров строк товаров,                |
                                     формат элемента: номер => ИД товара          |
                                                                                  |
============================================================================ --> *}{strip}

    {* <!-- =======================================================================
    |                                                                             |
    |  Закладки.                                                                  |
    |                                                                             |
    ======================================================================== --> *}

    {include '../../common_parts/submenu.htm'
             select = 'imports'
             main = TRUE
             imports = TRUE
             export = TRUE
             backup = TRUE
             redirects = TRUE
             mailer = TRUE}

    {* <!-- =======================================================================
    |                                                                             |
    |  Заголовок.                                                                 |
    |                                                                             |
    ======================================================================== --> *}

    <div class="box">
        <h1>
            <div class="path">
                <a href="{siteAdmin}">Главная</a> {**}
                → <a href="{siteAdmin}?section=Imports">Импорт</a> {**}
                → Результат
            </div>
            Результат импорта: {echoVar from='item->name'}
        </h1>

        {* <!-- ===================================================================
        |                                                                         |
        |  Инструментальные ссылки.                                               |
        |                                                                         |
        ==================================================================== --> *}

        <div class="toolkey">
            &nbsp;
        </div>

        {* <!-- ===================================================================
        |                                                                         |
        |  Информационное сообщение.                                              |
        |                                                                         |
        ==================================================================== --> *}

        {if !empty($message)}
            <div class="message">
                {$message}
            </div>
        {/if}

        {* <!-- ===================================================================
        |                                                                         |
        |  Сообщение об ошибке.                                                   |
        |                                                                         |
        ==================================================================== --> *}

        {if !empty($error)}
            <div class="error">
                <b>Ошибка:</b> {$error}
            </div>
        {/if}

        <p>
            Импорт данных завершен {(!empty($error)) ? 'с ошибкой. Описание ошибки указано выше' : 'успешно'}.
        </p>

        {* <!-- ===================================================================
        |                                                                         |
        |  Результаты по товарам, если есть.                                      |
        |                                                                         |
        ==================================================================== --> *}

        {if !empty($ProductsAdded) || !empty($ProductsUpdated) || !empty($ProductsSkiped) || empty($ProductsDeletedAncientQ0) || !empty($ProductsDeletedAncientS0)}
            <div>&nbsp;</div>
            <div><b>Результаты по товарам</b>:</div>

            {if !empty($ProductsAdded)}
                <div>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Было добавлено товаров: <b>{$ProductsAdded}</b>
                </div>
            {/if}

            {if !empty($ProductsUpdated)}
                <div>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Обновлено товаров: <b>{$ProductsUpdated}</b>
                </div>
            {/if}

            {if !empty($ProductsSkiped)}
                <div>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Неизменившихся товаров: <b>{$ProductsSkiped}</b>
                </div>
            {/if}

            {if !empty($ProductsDeletedAncientQ0)}
                <div>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Удалено устаревших (отсутствующих на складе) товаров: <b>{$ProductsDeletedAncientQ0}</b>
                </div>
            {/if}

            {if !empty($ProductsDeletedAncientS0)}
                <div>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Удалено устаревших (обесцененных) товаров: <b>{$ProductsDeletedAncientS0}</b>
                </div>
            {/if}
        {/if}

        {* <!-- ===================================================================
        |                                                                         |
        |  Результаты по вариантам товаров, если есть.                            |
        |                                                                         |
        ==================================================================== --> *}

        {if !empty($VariantsAdded) || !empty($VariantsUpdated) || !empty($VariantsSkiped)}
            <div>&nbsp;</div>
            <div><b>Результаты по видам товара</b>:</div>

            {if !empty($VariantsAdded)}
                <div>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Было добавлено видов товара: <b>{$VariantsAdded}</b>
                </div>
            {/if}

            {if !empty($VariantsUpdated)}
                <div>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Обновлено видов товара: <b>{$VariantsUpdated}</b>
                </div>
            {/if}

            {if !empty($VariantsSkiped)}
                <div>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Неизменившихся видов товара: <b>{$VariantsSkiped}</b>
                </div>
            {/if}
        {/if}

        {* <!-- ===================================================================
        |                                                                         |
        |  Результаты по брендам, если есть.                                      |
        |                                                                         |
        ==================================================================== --> *}

        {if !empty($BrandsAdded)}
            <div>&nbsp;</div>
            <div><b>Результаты по брендам</b>:</div>

            <div>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Было добавлено брендов: <b>{$BrandsAdded}</b>
            </div>
        {/if}

        {* <!-- ===================================================================
        |                                                                         |
        |  Результаты по категориям, если есть.                                   |
        |                                                                         |
        ==================================================================== --> *}

        {if !empty($CategoriesAdded)}
            <div>&nbsp;</div>
            <div><b>Результаты по категориям</b>:</div>

            <div>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Было добавлено категорий: <b>{$CategoriesAdded}</b>
            </div>
        {/if}

        {* <!-- ===================================================================
        |                                                                         |
        |  Результаты по свойствам, если есть.                                    |
        |                                                                         |
        ==================================================================== --> *}

        {if !empty($PropertiesAdded)}
            <div>&nbsp;</div>
            <div><b>Результаты по свойствам товаров</b>:</div>

            <div>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Было добавлено свойств: <b>{$PropertiesAdded}</b>
            </div>
        {/if}

        {* <!-- ===================================================================
        |                                                                         |
        |  Ссылка "Назад".                                                        |
        |                                                                         |
        ==================================================================== --> *}

        <p>
            <a href="{siteAdmin}?section=Imports">← список вариантов импорта</a>
        </p>

        {* <!-- ===================================================================
        |                                                                         |
        |  Неправильные строки, если есть.                                        |
        |                                                                         |
        ==================================================================== --> *}

        {if !empty($StatisticData->bads)}
            <div>&nbsp;</div>
            <div><b>Неправильные строки</b> (проигнорированы, так как число ячеек отличается от заявленных в списке полей):</div>

            <div>
                {foreach $StatisticData->bads as $number => $item}
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{$number} → {$item} ячеек<br />
                {/foreach}
            </div>
        {/if}

        {* <!-- ===================================================================
        |                                                                         |
        |  Отклоненные строки, если есть.                                         |
        |                                                                         |
        ==================================================================== --> *}

        {if !empty($StatisticData->skips)}
            <div>&nbsp;</div>
            <div><b>Отклоненные строки</b> (согласно минус-командам в списке полей):</div>

            <div>
                {foreach $StatisticData->skips as $item}
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{$item}<br />
                {/foreach}
            </div>
        {/if}

        {* <!-- ===================================================================
        |                                                                         |
        |  Товарные строки, если есть.                                            |
        |                                                                         |
        ==================================================================== --> *}

        {if !empty($StatisticData->ids)}
            <div>&nbsp;</div>
            <div><b>Товарные строки</b> (номер строки и идентификатор ее товара):</div>

            <div>
                {foreach $StatisticData->ids as $number => $item}
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{$number} → {$item}<br />
                {/foreach}
            </div>
        {/if}

        {* <!-- ===================================================================
        |                                                                         |
        |  Пустые строки, если есть.                                              |
        |                                                                         |
        ==================================================================== --> *}

        {if !empty($StatisticData->empties)}
            <div>&nbsp;</div>
            <div><b>Пустые строки</b> (проигнорированы):</div>

            <div>
                {foreach $StatisticData->empties as $item}
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{$item}<br />
                {/foreach}
            </div>
        {/if}
    </div>

{/strip}